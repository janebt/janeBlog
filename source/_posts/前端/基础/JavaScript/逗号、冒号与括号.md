---
title: 逗号、冒号与括号
date: 2017-02-27 21:01:34
updated: 2017-02-27 21:01:34
tags:
  - JavaScript
categories:
  - 基础
toc: true
---
有看见一些很好的博文做这点，感觉有必要对这些坑总结记录一下。

<!-- more -->

# 知识点

## 逗号

**连续声明一些变量**

**方法参数，对象属性**我们使用逗号隔开

**赋值表达式**

**Case**

```javascript
var a=(1,2,3);
```

在表达式与运算符中提到过逗号运算符就是对应这种情况，这时表达式计算结果是最后一个子表达式结果，也就是3。千万不要误会前面的子表达式不会执行，每个子表达式都会执行，只不过“返回值”是最后一个表达式结果。

**Case**

```javascript
var a,b;
a=(b=1,2);
console.log(a);//2
console.log(b);//1
```

## 冒号

**?:运算符**

**对象字面量**

**switch语句**

**声明label**

**Case**

```javascript
x:y:z:1,2,3;
//相当于
x:
 y:
  z:1,2,3
```

其实冒号还有个作用：声明label，JavaScript中语句可以有个标签前缀，我们称之为标记语句

## 大括号

**对象直接量声明**

**函数声明或者函数直接量**

**组织复合语句**

### 大括号没有带来块级作用域

1. 在function外使用声明变量（无论是否使用var）
2. 在function内不是用var 声明变量
3. 直接赋值于window属性
4. 除了这三种剩下的就是function范围内的局部变量了

**Case**

```javascript
{a:1};		//1
var x={a:1};
{a:1,b:2};	//报错
var y={a:1,b:2};
```

**{a:1}** JavaScript有传说中的“语句优先”，也就是当大括号既可以被理解为复合语句块也可以被理解为对象直接量的时候，JavaScript会将其理解为复合语句快。{a:1}其实就是 **a: 1**，想想冒号的作用是不是知道为什么返回值是1了。

**{a:1,b:2};** 看了上面这个就简单了，可以翻译为：**a:1,b:2** 结合逗号和冒号作用，结果似乎显而易见了，就是2嘛。然而其实报错了，这是为什么？在**逗号运算符后面必须是表达式**，而标签语句十个label statement，是条语句，所以就报错了。

**Case**

```javascript
{foo:[1,2,3]}[0];
{a:1}+2;
2+{a:1};
```

**大括号虽然看起来没什么作用，但起到了语句分隔符作用**，{foo:[1,2,3]}[0]可以理解为

```javascript
{foo:[1,2,3]};
[0];
```

所以返回值是[0]，同样{a:1}+2变为

```javascript
{a:1};
+2
```

但是！为什么2+{a:1}就不一样了呢？这时加法运算符导致的，加号是左结合的，{}被解析为表达式（得是表达式相加嘛），根据[数据类型](http://www.cnblogs.com/dolphinX/p/3521118.html)中知识对象{a:1}转换为NaN

## 小括号

**函数声明或调用表达式参数表**

**与一些关键字组成条件语句**

**分组运算符**

对于简单的json字符串转为对象的时候，因为浏览器兼容性原因，不能使用JSON对象，又懒得引入json2，所以就会用eval()处理，大概写法这样

```javascript
var jsonStr=...;
var jsonObj=eval('(' + jsonStr + ')');
```

为什么还要加上个小括号呢？像我们上面解释的大括号的作用，json字符串 "{a:1,b:2}" 这样的格式会被理解为语句，也就是传说中的label statement，上面提到过逗号运算符不能在label statement后面，所以会报错，而加上括号后由于分组运算符只能包含表达式，所以{}变成直接量语法，这样就是我们希望的内容了。

### 立即调用的函数表达式

函数表达式和函数声明区别:

常用的区分方式是根据上下文，如果function fn(){}作为右值出现（赋值表达式右边）那么就是表达式，否则就是函数声明。有几种看起来不常规的方式需要我们注意

```javascript
new function fn(){}; //表达式，因为在new 表达式中
(function(){}());//表达式，在分组运算符中
```

所以应该称立即执行函数为立即调用的函数表达式！

## 中括号

**数组相关**

**获取对象属性值**

**Case**

```javascript
[1,2,3,4,5][0..toString.length];	// 2
'foo'.split('') + [];	//"f,o,o"
```



# 问题



# 参考文章

- [JavaScript面试时候的坑洼沟洄——逗号、冒号与括号](http://www.cnblogs.com/dolphinX/p/3529249.html)

